<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AstralAlgo App</title>
  </head>
  <body>
    <h2>App Home</h2>
    <div id="status">Checking session…</div>

    <script>
      (async function () {
        try {
         const res = await fetch("/.netlify/functions/me", { credentials: "include" });
          if (!res.ok) throw new Error("Not logged in (no valid session cookie).");

          const data = await res.json();
          const u = data.user;

          document.getElementById("status").innerHTML =
            "<b>✅ Logged in</b><br/>" +
            "Name: " + (u.name || "-") + "<br/>" +
            "Email: " + (u.email || "-") + "<br/>" +
            "Tier: <b>" + (u.tier || "member") + "</b>";
        } catch (e) {
          document.getElementById("status").innerHTML =
            "<b>❌ Not logged in</b><br/>" +
            (e.message || e);
        }
      })();
    </script>
  </body>
</html>
